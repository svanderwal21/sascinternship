nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2023 NVIDIA Corporation
Built on Fri_Nov__3_17:16:49_PDT_2023
Cuda compilation tools, release 12.3, V12.3.103
Build cuda_12.3.r12.3/compiler.33492891_0
Fri Jan 19 09:26:13 2024       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 470.161.03   Driver Version: 470.161.03   CUDA Version: 11.4     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  GRID V100D-32Q      On   | 00000000:02:00.0 Off |                  N/A |
| N/A   N/A    P0    N/A /  N/A |   2192MiB / 32768MiB |      0%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
res-hpc-gpu06.researchlumc.nl
Cuda devices: 0
Testing model: BioMedGPT-LM-7B
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:26<00:53, 26.73s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:39<00:18, 18.28s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:44<00:00, 12.61s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:44<00:00, 14.99s/it]
Traceback (most recent call last):
  File "/exports/sascstudent/svanderwal2/programs/test_new_models/biomedtest.py", line 10, in <module>
    test_model("BioMedGPT-LM-7B", "fart")
  File "/exports/sascstudent/svanderwal2/programs/test_new_models/biomedtest.py", line 5, in test_model
    device = 0 if torch.cuda.is_available() and use_gpu else -1
                  ^^^^^
NameError: name 'torch' is not defined
