nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2022 NVIDIA Corporation
Built on Thu_Feb_10_18:23:41_PST_2022
Cuda compilation tools, release 11.6, V11.6.112
Build cuda_11.6.r11.6/compiler.30978841_0
Thu Feb  1 10:01:31 2024       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 470.161.03   Driver Version: 470.161.03   CUDA Version: 11.4     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  GRID V100D-32Q      On   | 00000000:02:00.0 Off |                  N/A |
| N/A   N/A    P0    N/A /  N/A |   2192MiB / 32768MiB |      0%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
res-hpc-gpu09.researchlumc.nl
Cuda devices: 0
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at BioLinkBERT-large and are newly initialized: ['classifier.weight', 'classifier.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
Read files
Converted labels
Tokenized data
Splitted data
Data converted into tensors
  0%|          | 0/192 [00:00<?, ?it/s]  1%|          | 1/192 [00:01<05:10,  1.63s/it]  1%|          | 2/192 [00:02<03:36,  1.14s/it]  2%|▏         | 3/192 [00:03<03:07,  1.01it/s]  2%|▏         | 4/192 [00:04<02:53,  1.09it/s]  3%|▎         | 5/192 [00:04<02:44,  1.13it/s]  3%|▎         | 6/192 [00:05<02:39,  1.17it/s]  4%|▎         | 7/192 [00:06<02:35,  1.19it/s]  4%|▍         | 8/192 [00:07<02:33,  1.20it/s]  5%|▍         | 9/192 [00:08<02:31,  1.21it/s]  5%|▌         | 10/192 [00:08<02:29,  1.22it/s]                                                  5%|▌         | 10/192 [00:08<02:29,  1.22it/s]  6%|▌         | 11/192 [00:09<02:28,  1.22it/s]  6%|▋         | 12/192 [00:10<02:27,  1.22it/s]  7%|▋         | 13/192 [00:11<02:26,  1.23it/s]  7%|▋         | 14/192 [00:12<02:25,  1.23it/s]  8%|▊         | 15/192 [00:12<02:24,  1.23it/s]  8%|▊         | 16/192 [00:13<02:23,  1.23it/s]  9%|▉         | 17/192 [00:14<02:22,  1.23it/s]  9%|▉         | 18/192 [00:15<02:21,  1.23it/s] 10%|▉         | 19/192 [00:16<02:20,  1.23it/s] 10%|█         | 20/192 [00:17<02:19,  1.23it/s]                                                 10%|█         | 20/192 [00:17<02:19,  1.23it/s] 11%|█         | 21/192 [00:17<02:19,  1.23it/s] 11%|█▏        | 22/192 [00:18<02:18,  1.23it/s] 12%|█▏        | 23/192 [00:19<02:17,  1.23it/s] 12%|█▎        | 24/192 [00:20<02:16,  1.23it/s] 13%|█▎        | 25/192 [00:21<02:15,  1.23it/s] 14%|█▎        | 26/192 [00:21<02:15,  1.23it/s] 14%|█▍        | 27/192 [00:22<02:14,  1.23it/s] 15%|█▍        | 28/192 [00:23<02:13,  1.23it/s] 15%|█▌        | 29/192 [00:24<02:12,  1.23it/s] 16%|█▌        | 30/192 [00:25<02:11,  1.23it/s]                                                 16%|█▌        | 30/192 [00:25<02:11,  1.23it/s] 16%|█▌        | 31/192 [00:26<02:11,  1.23it/s] 17%|█▋        | 32/192 [00:26<02:10,  1.23it/s] 17%|█▋        | 33/192 [00:27<02:09,  1.23it/s] 18%|█▊        | 34/192 [00:28<02:08,  1.23it/s] 18%|█▊        | 35/192 [00:29<02:07,  1.23it/s] 19%|█▉        | 36/192 [00:30<02:06,  1.23it/s] 19%|█▉        | 37/192 [00:30<02:06,  1.23it/s] 20%|█▉        | 38/192 [00:31<02:05,  1.23it/s] 20%|██        | 39/192 [00:32<02:04,  1.23it/s] 21%|██        | 40/192 [00:33<02:03,  1.23it/s]                                                 21%|██        | 40/192 [00:33<02:03,  1.23it/s] 21%|██▏       | 41/192 [00:34<02:02,  1.23it/s] 22%|██▏       | 42/192 [00:34<02:02,  1.23it/s] 22%|██▏       | 43/192 [00:35<02:01,  1.23it/s] 23%|██▎       | 44/192 [00:36<02:00,  1.23it/s] 23%|██▎       | 45/192 [00:37<01:59,  1.23it/s] 24%|██▍       | 46/192 [00:38<01:58,  1.23it/s] 24%|██▍       | 47/192 [00:39<01:58,  1.23it/s] 25%|██▌       | 48/192 [00:39<01:57,  1.23it/s] 26%|██▌       | 49/192 [00:40<01:56,  1.23it/s] 26%|██▌       | 50/192 [00:41<01:55,  1.23it/s]                                                 26%|██▌       | 50/192 [00:41<01:55,  1.23it/s] 27%|██▋       | 51/192 [00:42<01:54,  1.23it/s] 27%|██▋       | 52/192 [00:43<01:53,  1.23it/s] 28%|██▊       | 53/192 [00:43<01:53,  1.23it/s] 28%|██▊       | 54/192 [00:44<01:52,  1.23it/s] 29%|██▊       | 55/192 [00:45<01:51,  1.23it/s] 29%|██▉       | 56/192 [00:46<01:50,  1.23it/s] 30%|██▉       | 57/192 [00:47<01:49,  1.23it/s] 30%|███       | 58/192 [00:47<01:49,  1.23it/s] 31%|███       | 59/192 [00:48<01:48,  1.23it/s] 31%|███▏      | 60/192 [00:49<01:47,  1.23it/s]                                                 31%|███▏      | 60/192 [00:49<01:47,  1.23it/s] 32%|███▏      | 61/192 [00:50<01:46,  1.23it/s] 32%|███▏      | 62/192 [00:51<01:45,  1.23it/s] 33%|███▎      | 63/192 [00:52<01:44,  1.23it/s] 33%|███▎      | 64/192 [00:52<01:26,  1.48it/s] 34%|███▍      | 65/192 [00:53<01:30,  1.40it/s] 34%|███▍      | 66/192 [00:54<01:33,  1.34it/s] 35%|███▍      | 67/192 [00:54<01:35,  1.31it/s] 35%|███▌      | 68/192 [00:55<01:36,  1.29it/s] 36%|███▌      | 69/192 [00:56<01:36,  1.27it/s] 36%|███▋      | 70/192 [00:57<01:37,  1.26it/s]                                                 36%|███▋      | 70/192 [00:57<01:37,  1.26it/s] 37%|███▋      | 71/192 [00:58<01:36,  1.25it/s] 38%|███▊      | 72/192 [00:58<01:36,  1.24it/s] 38%|███▊      | 73/192 [00:59<01:36,  1.24it/s] 39%|███▊      | 74/192 [01:00<01:35,  1.24it/s] 39%|███▉      | 75/192 [01:01<01:34,  1.23it/s] 40%|███▉      | 76/192 [01:02<01:34,  1.23it/s] 40%|████      | 77/192 [01:02<01:33,  1.23it/s] 41%|████      | 78/192 [01:03<01:32,  1.23it/s] 41%|████      | 79/192 [01:04<01:31,  1.23it/s] 42%|████▏     | 80/192 [01:05<01:31,  1.23it/s]                                                 42%|████▏     | 80/192 [01:05<01:31,  1.23it/s] 42%|████▏     | 81/192 [01:06<01:30,  1.23it/s] 43%|████▎     | 82/192 [01:07<01:29,  1.23it/s] 43%|████▎     | 83/192 [01:07<01:28,  1.23it/s] 44%|████▍     | 84/192 [01:08<01:27,  1.23it/s] 44%|████▍     | 85/192 [01:09<01:27,  1.23it/s] 45%|████▍     | 86/192 [01:10<01:26,  1.23it/s] 45%|████▌     | 87/192 [01:11<01:25,  1.23it/s] 46%|████▌     | 88/192 [01:11<01:24,  1.23it/s] 46%|████▋     | 89/192 [01:12<01:23,  1.23it/s] 47%|████▋     | 90/192 [01:13<01:23,  1.23it/s]                                                 47%|████▋     | 90/192 [01:13<01:23,  1.23it/s] 47%|████▋     | 91/192 [01:14<01:22,  1.23it/s] 48%|████▊     | 92/192 [01:15<01:21,  1.23it/s] 48%|████▊     | 93/192 [01:15<01:20,  1.23it/s] 49%|████▉     | 94/192 [01:16<01:19,  1.23it/s] 49%|████▉     | 95/192 [01:17<01:18,  1.23it/s] 50%|█████     | 96/192 [01:18<01:18,  1.23it/s] 51%|█████     | 97/192 [01:19<01:17,  1.23it/s] 51%|█████     | 98/192 [01:20<01:16,  1.23it/s] 52%|█████▏    | 99/192 [01:20<01:15,  1.23it/s] 52%|█████▏    | 100/192 [01:21<01:14,  1.23it/s]                                                  52%|█████▏    | 100/192 [01:21<01:14,  1.23it/s] 53%|█████▎    | 101/192 [01:22<01:14,  1.23it/s] 53%|█████▎    | 102/192 [01:23<01:13,  1.23it/s] 54%|█████▎    | 103/192 [01:24<01:12,  1.23it/s] 54%|█████▍    | 104/192 [01:24<01:11,  1.23it/s] 55%|█████▍    | 105/192 [01:25<01:10,  1.23it/s] 55%|█████▌    | 106/192 [01:26<01:09,  1.23it/s] 56%|█████▌    | 107/192 [01:27<01:09,  1.23it/s] 56%|█████▋    | 108/192 [01:28<01:08,  1.23it/s] 57%|█████▋    | 109/192 [01:28<01:07,  1.23it/s] 57%|█████▋    | 110/192 [01:29<01:06,  1.23it/s]                                                  57%|█████▋    | 110/192 [01:29<01:06,  1.23it/s] 58%|█████▊    | 111/192 [01:30<01:05,  1.23it/s] 58%|█████▊    | 112/192 [01:31<01:05,  1.23it/s] 59%|█████▉    | 113/192 [01:32<01:04,  1.23it/s] 59%|█████▉    | 114/192 [01:33<01:03,  1.23it/s] 60%|█████▉    | 115/192 [01:33<01:02,  1.23it/s] 60%|██████    | 116/192 [01:34<01:01,  1.23it/s] 61%|██████    | 117/192 [01:35<01:00,  1.23it/s] 61%|██████▏   | 118/192 [01:36<01:00,  1.23it/s] 62%|██████▏   | 119/192 [01:37<00:59,  1.23it/s] 62%|██████▎   | 120/192 [01:37<00:58,  1.23it/s]                                                  62%|██████▎   | 120/192 [01:37<00:58,  1.23it/s] 63%|██████▎   | 121/192 [01:38<00:57,  1.23it/s] 64%|██████▎   | 122/192 [01:39<00:56,  1.23it/s] 64%|██████▍   | 123/192 [01:40<00:56,  1.23it/s] 65%|██████▍   | 124/192 [01:41<00:55,  1.23it/s] 65%|██████▌   | 125/192 [01:42<00:54,  1.23it/s] 66%|██████▌   | 126/192 [01:42<00:53,  1.23it/s] 66%|██████▌   | 127/192 [01:43<00:52,  1.23it/s] 67%|██████▋   | 128/192 [01:43<00:43,  1.48it/s] 67%|██████▋   | 129/192 [01:44<00:45,  1.40it/s] 68%|██████▊   | 130/192 [01:45<00:46,  1.34it/s]                                                  68%|██████▊   | 130/192 [01:45<00:46,  1.34it/s] 68%|██████▊   | 131/192 [01:46<00:46,  1.31it/s] 69%|██████▉   | 132/192 [01:47<00:46,  1.28it/s] 69%|██████▉   | 133/192 [01:48<00:46,  1.27it/s] 70%|██████▉   | 134/192 [01:48<00:46,  1.25it/s] 70%|███████   | 135/192 [01:49<00:45,  1.25it/s] 71%|███████   | 136/192 [01:50<00:45,  1.24it/s] 71%|███████▏  | 137/192 [01:51<00:44,  1.24it/s] 72%|███████▏  | 138/192 [01:52<00:43,  1.24it/s] 72%|███████▏  | 139/192 [01:52<00:42,  1.23it/s] 73%|███████▎  | 140/192 [01:53<00:42,  1.23it/s]                                                  73%|███████▎  | 140/192 [01:53<00:42,  1.23it/s] 73%|███████▎  | 141/192 [01:54<00:41,  1.23it/s] 74%|███████▍  | 142/192 [01:55<00:40,  1.23it/s] 74%|███████▍  | 143/192 [01:56<00:39,  1.23it/s] 75%|███████▌  | 144/192 [01:56<00:39,  1.23it/s] 76%|███████▌  | 145/192 [01:57<00:38,  1.23it/s] 76%|███████▌  | 146/192 [01:58<00:37,  1.23it/s] 77%|███████▋  | 147/192 [01:59<00:36,  1.23it/s] 77%|███████▋  | 148/192 [02:00<00:35,  1.23it/s] 78%|███████▊  | 149/192 [02:01<00:34,  1.23it/s] 78%|███████▊  | 150/192 [02:01<00:34,  1.23it/s]                                                  78%|███████▊  | 150/192 [02:01<00:34,  1.23it/s] 79%|███████▊  | 151/192 [02:02<00:33,  1.23it/s] 79%|███████▉  | 152/192 [02:03<00:32,  1.23it/s] 80%|███████▉  | 153/192 [02:04<00:31,  1.23it/s] 80%|████████  | 154/192 [02:05<00:30,  1.23it/s] 81%|████████  | 155/192 [02:05<00:30,  1.23it/s] 81%|████████▏ | 156/192 [02:06<00:29,  1.23it/s] 82%|████████▏ | 157/192 [02:07<00:28,  1.23it/s] 82%|████████▏ | 158/192 [02:08<00:27,  1.23it/s] 83%|████████▎ | 159/192 [02:09<00:26,  1.23it/s] 83%|████████▎ | 160/192 [02:10<00:26,  1.23it/s]                                                  83%|████████▎ | 160/192 [02:10<00:26,  1.23it/s] 84%|████████▍ | 161/192 [02:10<00:25,  1.23it/s] 84%|████████▍ | 162/192 [02:11<00:24,  1.23it/s] 85%|████████▍ | 163/192 [02:12<00:23,  1.23it/s] 85%|████████▌ | 164/192 [02:13<00:22,  1.23it/s] 86%|████████▌ | 165/192 [02:14<00:21,  1.23it/s] 86%|████████▋ | 166/192 [02:14<00:21,  1.23it/s] 87%|████████▋ | 167/192 [02:15<00:20,  1.23it/s] 88%|████████▊ | 168/192 [02:16<00:19,  1.23it/s] 88%|████████▊ | 169/192 [02:17<00:18,  1.23it/s] 89%|████████▊ | 170/192 [02:18<00:17,  1.23it/s]                                                  89%|████████▊ | 170/192 [02:18<00:17,  1.23it/s] 89%|████████▉ | 171/192 [02:18<00:17,  1.23it/s] 90%|████████▉ | 172/192 [02:19<00:16,  1.23it/s] 90%|█████████ | 173/192 [02:20<00:15,  1.23it/s] 91%|█████████ | 174/192 [02:21<00:14,  1.23it/s] 91%|█████████ | 175/192 [02:22<00:13,  1.23it/s] 92%|█████████▏| 176/192 [02:23<00:13,  1.23it/s] 92%|█████████▏| 177/192 [02:23<00:12,  1.23it/s] 93%|█████████▎| 178/192 [02:24<00:11,  1.23it/s] 93%|█████████▎| 179/192 [02:25<00:10,  1.23it/s] 94%|█████████▍| 180/192 [02:26<00:09,  1.23it/s]                                                  94%|█████████▍| 180/192 [02:26<00:09,  1.23it/s] 94%|█████████▍| 181/192 [02:27<00:08,  1.23it/s] 95%|█████████▍| 182/192 [02:27<00:08,  1.23it/s] 95%|█████████▌| 183/192 [02:28<00:07,  1.23it/s] 96%|█████████▌| 184/192 [02:29<00:06,  1.23it/s] 96%|█████████▋| 185/192 [02:30<00:05,  1.23it/s] 97%|█████████▋| 186/192 [02:31<00:04,  1.23it/s] 97%|█████████▋| 187/192 [02:31<00:04,  1.23it/s] 98%|█████████▊| 188/192 [02:32<00:03,  1.23it/s] 98%|█████████▊| 189/192 [02:33<00:02,  1.23it/s] 99%|█████████▉| 190/192 [02:34<00:01,  1.23it/s]                                                  99%|█████████▉| 190/192 [02:34<00:01,  1.23it/s] 99%|█████████▉| 191/192 [02:35<00:00,  1.23it/s]100%|██████████| 192/192 [02:35<00:00,  1.49it/s]                                                 100%|██████████| 192/192 [02:35<00:00,  1.49it/s]100%|██████████| 192/192 [02:35<00:00,  1.23it/s]
{'loss': 6.8258, 'learning_rate': 1.0000000000000002e-06, 'epoch': 0.16}
{'loss': 6.8201, 'learning_rate': 2.0000000000000003e-06, 'epoch': 0.31}
{'loss': 6.8287, 'learning_rate': 3e-06, 'epoch': 0.47}
{'loss': 6.8799, 'learning_rate': 4.000000000000001e-06, 'epoch': 0.62}
{'loss': 6.921, 'learning_rate': 5e-06, 'epoch': 0.78}
{'loss': 6.8639, 'learning_rate': 6e-06, 'epoch': 0.94}
{'loss': 6.7923, 'learning_rate': 7.000000000000001e-06, 'epoch': 1.09}
{'loss': 6.7909, 'learning_rate': 8.000000000000001e-06, 'epoch': 1.25}
{'loss': 6.8191, 'learning_rate': 9e-06, 'epoch': 1.41}
{'loss': 6.7948, 'learning_rate': 1e-05, 'epoch': 1.56}
{'loss': 6.8418, 'learning_rate': 1.1000000000000001e-05, 'epoch': 1.72}
{'loss': 6.7947, 'learning_rate': 1.2e-05, 'epoch': 1.88}
{'loss': 6.7132, 'learning_rate': 1.3000000000000001e-05, 'epoch': 2.03}
{'loss': 6.7457, 'learning_rate': 1.4000000000000001e-05, 'epoch': 2.19}
{'loss': 6.689, 'learning_rate': 1.5e-05, 'epoch': 2.34}
{'loss': 6.7453, 'learning_rate': 1.6000000000000003e-05, 'epoch': 2.5}
{'loss': 6.8324, 'learning_rate': 1.7000000000000003e-05, 'epoch': 2.66}
{'loss': 6.761, 'learning_rate': 1.8e-05, 'epoch': 2.81}
{'loss': 6.6934, 'learning_rate': 1.9e-05, 'epoch': 2.97}
{'train_runtime': 155.5736, 'train_samples_per_second': 9.777, 'train_steps_per_second': 1.234, 'train_loss': 6.79428106546402, 'epoch': 3.0}
Model trained
Traceback (most recent call last):
  File "/exports/sascstudent/svanderwal2/programs/test_new_models/classify_model_try.py", line 204, in <module>
    main()
  File "/exports/sascstudent/svanderwal2/programs/test_new_models/classify_model_try.py", line 197, in main
    eval_test(split_list, batch_size, trainer, attention_masks)
  File "/exports/sascstudent/svanderwal2/programs/test_new_models/classify_model_try.py", line 140, in eval_test
    trainer.evaluate(test_data)
  File "/exports/sascstudent/svanderwal2/miniconda3/envs/run_models_sasc/lib/python3.11/site-packages/transformers/trainer.py", line 3011, in evaluate
    output = eval_loop(
             ^^^^^^^^^^
  File "/exports/sascstudent/svanderwal2/miniconda3/envs/run_models_sasc/lib/python3.11/site-packages/transformers/trainer.py", line 3190, in evaluation_loop
    for step, inputs in enumerate(dataloader):
  File "/exports/sascstudent/svanderwal2/miniconda3/envs/run_models_sasc/lib/python3.11/site-packages/accelerate/data_loader.py", line 451, in __iter__
    current_batch = next(dataloader_iter)
                    ^^^^^^^^^^^^^^^^^^^^^
  File "/exports/sascstudent/svanderwal2/miniconda3/envs/run_models_sasc/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/exports/sascstudent/svanderwal2/miniconda3/envs/run_models_sasc/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 674, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/exports/sascstudent/svanderwal2/miniconda3/envs/run_models_sasc/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/exports/sascstudent/svanderwal2/miniconda3/envs/run_models_sasc/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/exports/sascstudent/svanderwal2/programs/test_new_models/classify_model_try.py", line 21, in __getitem__
    for key, val in self.encodings.items()
                    ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Tensor' object has no attribute 'items'. Did you mean: 'item'?
